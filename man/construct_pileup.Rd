% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/data_gen.R
\name{construct_pileup}
\alias{construct_pileup}
\title{Construct a per-gene pileup from BAM files (for single-study or multi-study)}
\usage{
construct_pileup(
  Gene,
  studylist,
  regionsFile,
  regionsFormat = c("auto", "SCISSOR_gaf", "gencode.regions"),
  geneCol = 1,
  regionsCol = NULL,
  bamFilesList,
  caseIDList,
  max_depth = 1e+05,
  strand.specific = FALSE,
  nCores = 10,
  outFile = NULL
)
}
\arguments{
\item{Gene}{a character of gene name}

\item{studylist}{a character vector of study IDs or abbreviation/name}

\item{regionsFile}{either a file path or a data.frame specifying gene regions.
If a file path is given, it is read using \code{read.table()} with automatic
handling of header/non-header cases.}

\item{regionsFormat}{character; one of \code{"auto"}, \code{"SCISSOR_gaf"},
or \code{"gencode.regions"}. In \code{"auto"} mode, the function attempts
to detect whether the file uses SCISSOR-style columns \code{gene_name} and
\code{regions}, falling back to \code{"gencode.regions"} otherwise.}

\item{geneCol}{integer; column index for the gene identifier when
\code{regionsFormat = "gencode.regions"}. Default is 1.}

\item{regionsCol}{integer; column index for the regions string when
\code{regionsFormat = "gencode.regions"}. Default is \code{NULL}, which
is interpreted as 2.}

\item{bamFilesList}{named list of character vectors of BAM file paths}

\item{caseIDList}{named list of character vectors of sample IDs corresponding
to \code{bamFilesList}}

\item{max_depth}{integer; max depth parameter for \code{Rsamtools::PileupParam}.
Default is 100000.}

\item{strand.specific}{Logical; whether to use strand-specific pileup.
If \code{TRUE}, only the "+" strand is retained (when strand information
is available). Default is \code{FALSE}.}

\item{nCores}{the number of cores for parallel computing. Default is 10.}

\item{outFile}{a directory with a file name to save outputs. Default is NULL.}
}
\value{
a pileup matrix, regions, and ranges of genomic positions
}
\description{
Construct a per-gene pileup from BAM files (for single-study or multi-study)
}
\examples{
\dontrun{
res <- construct_pileup(
  Gene          = "KEAP1",
  studylist     = c("LUAD", "HNSC"),
  regionsFile   = "/path/to/TCGA.hg19.gene.regions.txt",
  regionsFormat = "gencode.regions",
  geneCol       = 1,
  regionsCol    = 2,
  bamFilesList  = list(
    LUAD = luad_bam_paths,
    HNSC = hnsc_bam_paths
  ),
  caseIDList    = list(
    LUAD = luad_case_ids,
    HNSC = hnsc_case_ids
  ),
  max_depth       = 100000,
  strand.specific = FALSE,
  nCores          = 10
)
}
}
